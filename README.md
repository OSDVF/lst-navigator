# LST Navigátor
[![build](https://github.com/OSDVF/lst-navigator/actions/workflows/build.yml/badge.svg)](https://github.com/OSDVF/lst-navigator/actions/workflows/build.yml)
[![preview](https://github.com/OSDVF/lst-navigator/actions/workflows/preview.yml/badge.svg)](https://github.com/OSDVF/lst-navigator/actions/workflows/preview.yml)
[![live](https://github.com/OSDVF/lst-navigator/actions/workflows/deployment.yml/badge.svg)](https://github.com/OSDVF/lst-navigator/actions/workflows/deployment.yml)

Použito pro akce [Moravskoslezské mládeže Českobratrské Církve Evangelické](https://msmladez.cz/)  
Used for [Moravian-Silesian Youth of Evangelic Church of Czech Brethren](https://msmladez.cz/) events  

# User features
- Program schedule
- Configurable feedback questions for each schedule item
- Completely custom feedback questions
- Basic user permission system
- Administration page for schedule, user and feedback form managent
- Multiple events support

## Technical features
- is a PWA
- Serverless architecture (Firebase auth, firestore, storage and hosting)
- Maintenance tasks on each build
    - Checking database references (`modules/db-check.ts`)
    - Mirroring google account login page for precaching and CSR compliance (`modules/mirror-auth.ts`)
- SSR generated static schedule pages

## WIP
- Notifications

## Setup
Look at the [Nuxt 3 documentation](https://nuxt.com/docs/getting-started/introduction) to learn more.

1. Make sure to install the dependencies:
- [bun](https://bun.sh/)
- dependencies in project folder
```bash
bun install
```

2. Copy `.env.example` into `.env` and fill in the environment variables.
3. Create `service-account.json` which will be used for SSR-side firebase authentication and paste your firebase service account credentials there.

## Development Server

Start the development server on `https://localhost:3000`:

```bash
bun dev
```

Note the server runs behind HTTPS wihtout HTTP redirects (otherswise firebase auth won't work).

## Production

Build the application for production:

```bash
bun generate
```

Locally preview production build:

```bash
bun serve
```

Check out the [deployment documentation](https://nuxt.com/docs/getting-started/deployment) for more information.

## Deployment
- Dostupné na https://lst.msmladez.cz  
  Live channel at https://lst.msmladez.cz (generated by `deployment.yml` workflow)  

- Preview channel URL automatically generated by firebase (look at existing workflow runs log for `preview.yml` at Github Actions page).
- Preview and Deployment workflows are using build artifacts generated by `build.yml` workflow.

In `tasks.json` there can be found "Create a deployment" task that triggers `deployment.yml` workflow and deploys a new live version.

## Development Tools
### Recommended VSCode Extensions
- [Volar](https://marketplace.visualstudio.com/items?itemName=johnsoncodehk.volar)
- [ESLint](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)
- [Bun for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=oven.bun-vscode)
- [Firebase](https://marketplace.visualstudio.com/items?itemName=toba.vsfire) for security rules syntax highlighting
- [Iconify Intellisense](https://marketplace.visualstudio.com/items?itemName=antfu.iconify)